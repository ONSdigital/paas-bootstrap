{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:ListBucket",
                "s3:ListBucketVersions",
                "s3:GetBucketVersioning",
                "s3:GetObject",
                "s3:GetObjectVersion",
                "s3:GetObjectTagging"
            ],
            "Resource": [
                "arn:aws:s3:::ons-paas-${environment}-states/*",
                "arn:aws:s3:::ons-paas-${environment}-states"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:DescribeKey",
                "kms:GetKeyPolicy",
                "kms:GetKeyRotationStatus",
                "kms:ListResourceTags"
            ],
            "Resource": [
                "${s3_kms_key_arn}",
                "arn:aws:kms:${region}:${account_id}:*",
                "arn:aws:kms:${region}:${account_id}:key/*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "kms:CreateKey",
                "kms:GenerateDataKey"
            ],
            "Resource": [
                "*"
            ]
        }
    ]
}