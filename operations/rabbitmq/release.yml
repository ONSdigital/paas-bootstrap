---

# https://bosh.io/releases/github.com/pivotal-cf/cf-rabbitmq-multitenant-broker-release?all=1
- type: replace
  path: /releases/name=cf-rabbitmq-multitenant-broker?
  value:
    name: "cf-rabbitmq-multitenant-broker"
    version: "37.0.0"
    url: "https://bosh.io/d/github.com/pivotal-cf/cf-rabbitmq-multitenant-broker-release?v=37.0.0"
    sha1: "146049116e60593af959d1c738a139b59e8480a7"

- type: remove
  path: /releases/name=cf-rabbitmq-smoke-tests

- type: replace
  path: /releases/name=rabbitmq-smoke-tests?
  value:
    name: "rabbitmq-smoke-tests"
    version: "4"
    url: "https://bosh.io/d/github.com/cloudfoundry-community/rabbitmq-smoke-tests-boshrelease?v=4"
    sha1: "06004fa77387f4443236117604870d9eeb93acb1"

- type: replace
  path: /releases/name=cf-rabbitmq?
  value:
    name: "cf-rabbitmq"
    version: "251.0.0"
    url: "https://bosh.io/d/github.com/pivotal-cf/cf-rabbitmq-release?v=251.0.0"
    sha1: "6b26a898eb7d908b4325f6010917a228986c7ec0"

- type: replace
  path: /instance_groups/name=rmq-broker/networks
  value:
  - name: services

- type: replace
  path: /instance_groups/name=rmq/networks
  value:
  - name: services

- type: replace
  path: /instance_groups/name=haproxy/networks
  value:
  - name: services

- type: replace
  path: /instance_groups/name=rmq-broker/azs
  value: [z1, z2, z3]

- type: replace
  path: /instance_groups/name=rmq/azs
  value: [z1, z2, z3]


- type: replace
  path: /instance_groups/name=haproxy/azs
  value: [z1, z2, z3]


# FIXME: the pivotal RMQ release gives bogus examples
# - type: replace
#   path: /instance_groups/name=rmq/jobs/name=rabbitmq-server/properties/rabbitmq-server/disk_alarm_threshold?
#   value:
#     mem_relative: 0.4
- type: remove
  path: /instance_groups/name=rmq/jobs/name=rabbitmq-server/properties/rabbitmq-server/disk_alarm_threshold


# The BOSH release appears not to be cf-rabbitmq-smoke-tests, so change to suit
- type: replace
  path: /instance_groups/name=rmq-broker/jobs/name=smoke-tests/release
  value: rabbitmq-smoke-tests

- type: remove
  path: /instance_groups/name=rmq-broker/jobs/name=rabbitmq-broker/properties/rabbitmq-broker/rabbitmq/hosts

- type: replace
  path: /instance_groups/name=rmq-broker/jobs/name=smoke-tests/properties/cf/apps_domain?
  value: ((apps_domain))

- type: replace
  path: /instance_groups/name=rmq-broker/jobs/name=smoke-tests/properties/rabbitmq?/plan_names?
  value: [standard]

- type: replace
  path: /instance_groups/name=rmq-broker/jobs/name=smoke-tests/properties/rabbitmq?/service_name?
  value: ((product-name))

# - type: remove
#   path: /instance_groups/name=rmq-broker/jobs/name=smoke-tests

- type: replace
  path: /variables?/-
  value:
    name: rabbitmq-management-password
    type: password

- type: replace
  path: /variables?/-
  value:
    name: multitenant-rabbitmq-broker-password
    type: password

- type: replace
  path: /variables?/-
  value:
    name: haproxy-stats-password
    type: password

